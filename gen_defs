#!/bin/sh
# shellcheck disable=SC1004

# $Id$

echo '/* Automatically generated by gen_defs.  Do not edit! */'
echo ''

for mode in help defs; do
	case $mode in
		help)
			echo "#ifdef HELP_C"
			echo "const char *HelpStrings[] = {"
			;;
		*)
			echo "enum {"
			;;
	esac
	for i in "$@"; do
		if test $mode = help; then
			{
				number=1
				while IFS="" read -r oneline; do
					printf "%d %s\n" $number "$oneline"
					number=`expr $number + 1`
				done
			} < "$i" | \
			sed -e 's;^[0-9]* \(\/\*.*\*\/\);\1;' \
			-e 's;^\([0-9]*\) \(OP_[^ ]*\) *\(.*\);	/* L10N: Help screen description for \2\
#: '"$i"':\1 */\
	N_(\3),;'
		else
			sed -e '/^\/\*/d' -e 's;^\([^ ]*\).*;	\1,;' < "$i"
		fi
	done
	if test $mode = help; then
		echo '	NULL'
	else
		echo '	OP_MAX'
	fi
	echo "};"
	if test $mode = help; then
		echo "#endif /* MAIN_C */"
		echo ''
	fi
done

exit 0
